.row
  .col-md-12
    %h2
      Users
      - if @users
        = "(#{@users.length})"

      = link_to "New User", new_admin_user_path, class: 'btn btn-success pull-right'
    .well
      %table.table.table-striped.table-bordered.table-hover#users
        %thead
          %th
            %b ID
          %th
            %b State
          %th
            %b Email
          %th
            %b Name
          %th
            %b # of Conference Registrations
          %th
            %b Roles
          %th
          %th
          %th
        - @users.each do |user|
          %tr
            %td
              = user.id
            %td
              - if user.confirmed?
                confirmed
              - else
                unconfirmed
            %td
              = user.email
            %td
              = user.name
            %td
              = user.registrations.count
            %td
              - if can? :update, Role
                = link_to "#{ user.roles.present? ? (user.roles.map { |role| "#{ role.name.titleize }(#{ role.resource_type.constantize.find(role.resource_id).short_title })" }.join ', ') : 'Add Role'}", "#", "data-toggle" => "modal", "data-target" => "#user-role-selection-#{user.id}",id: "user-modify-role-#{user.id}"

              - else
                = user.roles.map { |role| "#{ role.name.capitalize } for #{ role.resource_type.constantize.find(role.resource_id).short_title }" }.join ', '
            - if can? :show, user
              %td
                = link_to "View", admin_user_path(user), class: 'btn btn-success'
            - if can? :update, user
              %td
                = link_to "Edit", edit_admin_user_path(user), class: 'btn btn-primary'
            - if can? :destroy, user
              %td= link_to 'Delete',admin_user_path(user), :method=> :delete , :data=> {:confirm => 'Are you sure ?'},:class => "btn btn-primary btn-danger"
            - else
              %td= link_to 'Delete',admin_user_path(user), :method => :delete , :data => {:confirm => 'Are you sure ?'}, :disabled => true,:class => "btn btn-primary disabled btn-danger",:role => "button"


:javascript
  $(document).ready(function() {
      $('#users').dataTable( {
        "bPaginate": false,
        "bLengthChange": false
      } );
  } );
