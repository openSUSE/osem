.unobtrusive-flash-container

.row
  .col-md-12
    .page-header
      %h1 Schedule
      .row
        .col-md-10.col-xs-8
          %p.text-muted
            Create the schedules for the conference
        .col-md-2.col-xs-4
          .text-right
            %button.btn.btn-success.schedule-save
              Save

- if @rooms.present?
  .row
    .col-md-2
      Selected schedule
      = check_box_tag @conference.short_title, @schedule.id, (@schedule.id == @selected_schedule.try(:id)),
        method: :patch, url: (admin_conference_program_path(@conference.short_title) + '?[program][selected_schedule_id]='),
        class: 'switch-checkbox-schedule', data: { size: 'small',
                                          off_color: 'warning',
                                          on_text: 'Yes',
                                          off_text: 'No' }
      .h4
        Unscheduled events
      .unscheduled-events
        - @unscheduled_events.each do |e|
          = render partial: 'event', locals: { event: e, event_schedule_id: nil }
    .col-md-10
      %ul.nav.nav-tabs
        - @dates.each do |date|
          %li{ class: "#{ (@dates.first == date) ? 'active' : '' }"}
            %a{ href: "##{date}" }
              = date
      .tab-content
        - @dates.each do |date|
          .tab-pane{ class: "#{ (@dates.first == date) ? 'active' : '' }", id: "#{date}" }
            = render partial: 'day_tab', locals: { date: date }
  .row
    .col-md-12.text-right
      %button.btn.btn-success.schedule-save
        Save
- else
  .h3
    No Rooms!
    %small
      = link_to 'Create rooms', admin_conference_venue_rooms_path
      before creating the schedule.

:javascript
  $(document).ready( function() {
    // When reload the page after saving, show flash messages in the url.
    var url = window.location.href;
    if (url.indexOf("?") > 0){
      var params = (url.split("?"))[1].split(/[&=]/);
      if(params[0] == 'flash' && params[2] == 'type')
        showMessage(decodeURI(params[1]), params[3]);
    }

    Schedule.initialize("#{@conference.short_title}", "#{@schedule.id}");
  });
